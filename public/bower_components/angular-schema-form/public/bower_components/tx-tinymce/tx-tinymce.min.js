angular.module("tx-tinymce",[]).directive("txTinymce",[function(){var n=0;return{restrict:"AC",require:"ngModel",scope:!1,link:function(e,t,i,o){var c;if(i.id){window.jQuery&&jQuery("label[for="+i.id+"]")}else i.$set("id","tx-tinymce-"+n++);var r=function(n){n=angular.extend(n||{},{selector:"#"+i.id,setup:function(n){c=n,console.log(c),window["focus"+i.id]=function(){c.execCommand("mceFocus",!1,i.id)};var t=function(){var t=n.getContent();o.$viewValue!==t&&(o.$setViewValue(t),e.$root.$$phase||e.$apply())};n.on("change",t),n.on("KeyUp",t),n.on("ExecCommand",t)}}),tinyMCE.init(n)},a=function(){c&&(c.save(),c.remove(),c=null)};e.destroy=a,e.$on("$destroy",a),i.txTinymce?e.$watch(i.txTinymce,function(n){n&&(a(),r(n))}):r(),e.$watch(i.ngModel,function(n){if(c&&angular.isDefined(n)){var e=c.getContent();angular.isString(n)&&e!==n&&c.setContent(n)}})}}}]);